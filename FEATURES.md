# 기능 상세 설명 (Features Documentation)

## 🎯 핵심 기능

### 1. 데이터 분석 (Pandas)

#### 1.1 전체 통계 계산
- **총 매출 (Total Sales)**: 모든 거래의 매출 합계
- **총 이익 (Total Profit)**: 모든 거래의 이익 합계
- **이익률 (Profit Margin)**: (총 이익 / 총 매출) × 100
- **평균 매출 (Average Sales)**: 거래당 평균 매출
- **평균 이익 (Average Profit)**: 거래당 평균 이익
- **중간값 (Median)**: 매출의 중간값
- **최대/최소값**: 가장 큰/작은 거래 금액
- **총 주문 수 (Total Orders)**: 전체 거래 건수
- **총 판매 수량 (Total Quantity)**: 판매된 제품 총 수량

**구현 코드:**
```python
stats['total_sales'] = float(df['Sales'].sum())
stats['avg_sales'] = float(df['Sales'].mean())
stats['profit_margin'] = float(df['Profit'].sum() / df['Sales'].sum() * 100)
```

#### 1.2 카테고리별 분석
- 각 카테고리의 총 매출 및 이익
- 카테고리별 평균 매출
- 카테고리별 거래 건수
- 카테고리별 수익성 비교

**구현 코드:**
```python
category_stats = df.groupby('Category').agg({
    'Sales': ['sum', 'mean', 'count'],
    'Profit': 'sum'
}).round(2)
```

**출력 예시:**
```
Furniture:
  Total Sales:  $42,000.00
  Total Profit: $3,500.00
  Orders:       150
  Avg Sales:    $280.00
```

#### 1.3 서브카테고리 분석
- 상위 10개 서브카테고리 식별
- 서브카테고리별 매출 순위
- 인기 제품군 파악

**구현 코드:**
```python
subcategory_stats = df.groupby('Sub-Category')['Sales'].sum()\
                      .sort_values(ascending=False).head(10)
```

#### 1.4 지역별 분석
- 상위 10개 지역의 매출 및 이익
- 지역별 수익성 비교
- 손실 지역 식별 (음수 이익)

**구현 코드:**
```python
region_stats = df.groupby(region_column).agg({
    'Sales': 'sum',
    'Profit': 'sum'
}).sort_values('Sales', ascending=False).head(10)
```

#### 1.5 세그먼트 분석
- 고객 세그먼트별 매출 및 이익
- 세그먼트별 평균 거래 금액
- 가장 수익성 높은 세그먼트 식별

**구현 코드:**
```python
segment_stats = df.groupby('Segment').agg({
    'Sales': ['sum', 'mean'],
    'Profit': 'sum'
}).round(2)
```

#### 1.6 시계열 분석
- 월별 매출 추세
- 계절성 패턴 식별
- 성장률 계산

**구현 코드:**
```python
df['YearMonth'] = df[date_column].dt.to_period('M')
monthly_stats = df.groupby('YearMonth')['Sales'].sum()
```

### 2. 데이터 시각화 (Matplotlib)

#### 2.1 카테고리별 매출 차트
- **유형**: 가로 막대 차트 (Horizontal Bar Chart)
- **색상**: Steelblue
- **목적**: 카테고리 간 매출 비교

**특징:**
- 깔끔한 그리드 배경
- 명확한 축 레이블
- 고해상도 (300 DPI)

#### 2.2 지역별 이익 차트
- **유형**: 가로 막대 차트
- **색상**: 녹색(양수 이익), 빨간색(음수 이익)
- **목적**: 수익성 높은/낮은 지역 식별

**특징:**
- 상위 10개 지역만 표시
- 이익 방향에 따른 색상 구분
- 시각적으로 문제 지역 강조

#### 2.3 서브카테고리 매출 차트
- **유형**: 세로 막대 차트 (Vertical Bar Chart)
- **색상**: Coral
- **목적**: 인기 제품 카테고리 파악

**특징:**
- 상위 10개만 표시
- 레이블 45도 회전 (가독성)
- 막대 폭 자동 조정

#### 2.4 세그먼트 비교 차트
- **유형**: 그룹 막대 차트 (Grouped Bar Chart)
- **색상**: Steelblue(매출), Orange(이익)
- **목적**: 세그먼트별 매출과 이익 동시 비교

**특징:**
- 두 지표를 나란히 비교
- 범례 자동 생성
- 균형잡힌 척도

#### 2.5 매출-이익 상관관계 차트
- **유형**: 산점도 (Scatter Plot)
- **색상**: 녹색(양수 이익), 빨간색(음수 이익)
- **목적**: 매출과 이익의 관계 파악

**특징:**
- 각 거래를 점으로 표시
- 0 이익 기준선 표시
- 투명도로 밀집도 표현

#### 2.6 월별 매출 추세 차트
- **유형**: 선 그래프 (Line Chart)
- **색상**: Steelblue
- **목적**: 시간에 따른 매출 변화 추적

**특징:**
- 마커로 각 월 강조
- 그리드로 값 읽기 쉽게
- 연속적인 트렌드 표시

### 3. AI 분석 (GPT API)

#### 3.1 자연어 보고서 생성
- OpenAI GPT-4o 모델 사용
- 한국어로 전문적인 비즈니스 보고서 작성
- 데이터 기반 인사이트 제공

**프롬프트 구조:**
```
당신은 전문 비즈니스 분석가입니다.

보고서 구조:
1. 전체 개요 (Executive Summary)
2. 주요 발견 사항 (Key Findings)
3. 카테고리 분석
4. 지역 분석
5. 세그먼트 분석
6. 개선 제안 및 마케팅 전략
7. 결론

데이터: [통계 정보]
```

#### 3.2 생성되는 내용

**전체 개요:**
- 비즈니스 전반적인 상태
- 주요 지표 요약
- 핵심 성과 강조

**주요 발견 사항:**
- 데이터에서 발견된 중요한 패턴
- 예상치 못한 트렌드
- 주목할 만한 이상치

**카테고리 분석:**
- 각 카테고리의 강점/약점
- 성장 기회
- 개선이 필요한 영역

**지역 분석:**
- 지역별 특성
- 수익성 높은 시장
- 투자 우선순위

**세그먼트 분석:**
- 고객 그룹별 특성
- 타겟팅 전략
- 고객 생애 가치

**마케팅 전략:**
- 구체적인 실행 계획
- 단기/장기 목표
- ROI 최적화 방안

**결론:**
- 핵심 메시지
- 다음 단계 제안
- 우선순위 설정

#### 3.3 API 설정
```python
client = OpenAI(api_key=os.environ.get('OPENAI_API_KEY'))

response = client.chat.completions.create(
    model="gpt-4o",
    messages=[
        {
            "role": "system",
            "content": "전문 비즈니스 분석가..."
        },
        {
            "role": "user",
            "content": prompt
        }
    ],
    temperature=0.7,
    max_tokens=2000
)
```

### 4. PDF 생성 (ReportLab)

#### 4.1 문서 구조
- **페이지 크기**: A4
- **여백**: 72pt (1인치)
- **폰트**: Helvetica
- **해상도**: 300 DPI (차트)

#### 4.2 스타일링

**제목 스타일:**
- 크기: 24pt
- 색상: #1f4788 (진한 파란색)
- 정렬: 중앙
- 굵기: Bold

**본문 스타일:**
- 크기: 11pt
- 줄 간격: 16pt
- 정렬: 양쪽 정렬
- 폰트: Helvetica

**테이블 스타일:**
- 헤더: 진한 파란색 배경, 흰색 텍스트
- 본문: 교대로 흰색/회색 배경
- 테두리: 회색 선
- 패딩: 적절한 여백

#### 4.3 레이아웃 요소

**표지 페이지:**
- 중앙 정렬 제목
- 부제목
- 생성 날짜

**통계 테이블:**
- 2열 레이아웃 (지표명, 값)
- 명확한 헤더
- 정렬된 숫자

**차트 페이지:**
- 페이지당 2개 차트
- 차트 제목 포함
- 적절한 간격

**분석 텍스트:**
- 섹션별 헤딩
- 불릿 포인트
- 단락 구분

### 5. 웹 인터페이스

#### 5.1 파일 업로드
- **드래그 앤 드롭**: 직관적인 인터페이스
- **파일 선택**: 전통적인 방식
- **실시간 검증**: 파일 형식 및 크기 확인
- **피드백**: 업로드 상태 표시

#### 5.2 진행 상황 표시
- **시각적 진행바**: 0-100% 표시
- **단계별 메시지**: 현재 작업 설명
- **애니메이션**: 부드러운 전환

**진행 단계:**
1. 파일 업로드 중... (20%)
2. Pandas로 데이터 분석 중... (40%)
3. GPT API로 분석 보고서 생성 중... (60%)
4. Matplotlib 차트 생성 중... (80%)
5. ReportLab으로 PDF 생성 중... (90%)
6. PDF 다운로드 중... (100%)

#### 5.3 반응형 디자인
- **모바일**: 1열 레이아웃
- **태블릿**: 2열 레이아웃
- **데스크톱**: 4열 그리드

#### 5.4 사용자 경험
- **부드러운 애니메이션**: fadeIn, transform
- **직관적 아이콘**: 이모지 활용
- **색상 코딩**: 성공(녹색), 오류(빨간색)
- **명확한 피드백**: 성공/오류 메시지

### 6. Express.js 서버

#### 6.1 API 엔드포인트

**POST /api/generate-report**
- 파일 업로드 및 보고서 생성
- Multipart form data 수용
- PDF 응답 반환

**GET /api/health**
- 서버 상태 확인
- 버전 정보 제공

#### 6.2 파일 처리
- **업로드**: Multer 미들웨어
- **저장**: 임시 디렉토리
- **정리**: 자동 삭제 (60초 후)

#### 6.3 보안
- **파일 형식 검증**: .csv, .xlsx, .xls만 허용
- **크기 제한**: 10MB 기본 제한
- **CORS 활성화**: 크로스 오리진 요청 허용

#### 6.4 에러 처리
- **graceful error handling**: 에러 시 적절한 응답
- **정리 작업**: 실패 시 파일 삭제
- **로깅**: 콘솔에 에러 기록

## 🎨 디자인 특징

### 색상 팔레트
- **주 색상**: #667eea (보라색 그라디언트)
- **보조 색상**: #764ba2 (진한 보라색)
- **액센트**: #11998e (청록색)
- **성공**: #4caf50 (녹색)
- **경고**: #ffd54f (노란색)
- **오류**: #c62828 (빨간색)

### 타이포그래피
- **헤딩**: Segoe UI Bold
- **본문**: Segoe UI Regular
- **코드**: Courier New

### 레이아웃
- **최대 너비**: 1200px
- **여백**: 적절한 padding/margin
- **그리드**: CSS Grid 및 Flexbox

## 🔧 기술 스택

### 백엔드
- **Node.js**: JavaScript 런타임
- **Express.js**: 웹 프레임워크
- **Python 3**: 데이터 분석

### 데이터 처리
- **Pandas**: 데이터 분석
- **NumPy**: 수치 계산
- **Matplotlib**: 데이터 시각화
- **Seaborn**: 통계 시각화

### AI
- **OpenAI API**: GPT-4o 모델
- **자연어 처리**: 분석 보고서 생성

### 문서 생성
- **ReportLab**: PDF 생성
- **Pillow**: 이미지 처리

### 프론트엔드
- **HTML5**: 구조
- **CSS3**: 스타일링
- **JavaScript**: 인터랙션

### 파일 처리
- **Multer**: 파일 업로드
- **dotenv**: 환경 변수

## 📊 데이터 흐름

```
1. 사용자가 CSV/XLSX 파일 업로드
        ↓
2. Express.js 서버가 파일 수신
        ↓
3. Python analyze_sales.py 실행
   - Pandas로 데이터 로드
   - 통계 계산
   - Matplotlib로 차트 생성
        ↓
4. Python generate_gpt_report.py 실행
   - 통계 데이터를 GPT API로 전송
   - 자연어 분석 보고서 수신
        ↓
5. Python generate_pdf.py 실행
   - ReportLab으로 PDF 생성
   - 통계 테이블 추가
   - 차트 이미지 삽입
   - GPT 분석 텍스트 추가
        ↓
6. Express.js가 PDF를 클라이언트로 전송
        ↓
7. 브라우저가 PDF 자동 다운로드
        ↓
8. 임시 파일 정리
```

## 🚀 성능

### 처리 시간 (예상)
- 소규모 파일 (< 1,000 행): ~10-15초
- 중규모 파일 (1,000-10,000 행): ~15-25초
- 대규모 파일 (10,000+ 행): ~25-40초

**주요 시간 소요 작업:**
1. Pandas 데이터 분석: 2-5초
2. GPT API 호출: 5-10초
3. Matplotlib 차트 생성: 3-5초
4. ReportLab PDF 생성: 2-3초

### 최적화 방안
- 차트 해상도 조정
- GPT API 타임아웃 설정
- 데이터 샘플링 (대용량 파일)
- 캐싱 활용

## 🎓 사용 사례

### 1. 월간 매출 보고서
- 매월 말 판매 데이터 업로드
- 자동으로 전문적인 보고서 생성
- 경영진에게 배포

### 2. 분기별 성과 분석
- 분기 데이터 종합 분석
- 카테고리별 성과 비교
- 전략 수립 자료

### 3. 지역별 시장 분석
- 지역별 판매 데이터 분석
- 수익성 높은 시장 식별
- 마케팅 예산 배분

### 4. 제품 포트폴리오 분석
- 서브카테고리별 성과 평가
- 인기 제품 식별
- 재고 관리 최적화

이 문서는 Sales Report Generator의 모든 기능을 상세히 설명합니다. 추가 질문이나 개선 제안이 있으시면 언제든지 문의해주세요! 🚀

